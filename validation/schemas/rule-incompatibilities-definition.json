{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://selphira.github.io/BigWorldSetup-Enhanced-Edition/validation/schemas/incompatibilities.json",
  "title": "Big World Setup - Next Generation: Incompatibility Rules",
  "description": "Schema for validating incompatibility rules files",
  "type": "object",
  "required": ["rules"],
  "additionalProperties": false,
  "properties": {
    "rules": {
      "type": "array",
      "items": {"$ref": "#/definitions/incompatibilityRule"}
    }
  },
  "definitions": {
    "ruleSeverity": {
      "type": "string",
      "enum": ["error", "warning", "info"],
      "default": "error",
      "description": "Severity level of the rule violation"
    },
    "rule": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\)(?:\\s*[&|]\\s*[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\))*(?:\\s*:\\s*[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\)(?:\\s*[&|]\\s*[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\))*)+$",
      "description": "Rule notation."
    },
    "incompatibilityRule": {
      "type": "object",
      "required": ["rule"],
      "additionalProperties": false,
      "properties": {
        "rule": {
          "$ref": "#/definitions/rule"
        },
        "severity": {
          "$ref": "#/definitions/ruleSeverity"
        },
        "description": {
          "type": "string",
          "description": "Human-readable explanation of the rule"
        },
        "translations": {
          "type": "object",
          "description": "Translations per language code",
          "minProperties": 1,
          "patternProperties": {
            "^[a-z]{2}_[A-Z]{2}$": {
              "type": "string",
              "minLength": 1
            }
          },
          "additionalProperties": false
        },
        "source_url": {
          "type": "string",
          "format": "uri",
          "description": "Optional URL for documentation or source reference"
        }
      }
    }
  }
}