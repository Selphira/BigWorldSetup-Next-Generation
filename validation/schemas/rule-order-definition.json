{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://selphira.github.io/BigWorldSetup-Enhanced-Edition/validation/schemas/order.json",
  "title": "Big World Setup - Enhanced Edition: Order Rules",
  "description": "Schema for validating order rules files",
  "type": "object",
  "required": ["rules"],
  "additionalProperties": false,
  "properties": {
    "rules": {
      "type": "array",
      "items": {"$ref": "#/definitions/orderRule"}
    }
  },
  "definitions": {
    "ruleSeverity": {
      "type": "string",
      "enum": ["error", "warning", "info"],
      "default": "error",
      "description": "Severity level of the rule violation"
    },
    "orderDirection": {
      "type": "string",
      "enum": ["before", "after"],
      "default": "before"
    },
    "rule": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\)(?:\\s*[&|]\\s*[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\))*\\s*:\\s*[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\)(?:\\s*[&|]\\s*[a-zA-Z0-9_#'+-]+\\((?:-|\\d+(?:\\.\\d+)*(?:,\\d+(?:\\.\\d+)*)*)\\))*$",
      "description": "Rule notation."
    },
    "orderRule": {
      "type": "object",
      "required": ["rule"],
      "additionalProperties": false,
      "properties": {
        "rule": {
          "$ref": "#/definitions/rule"
        },
        "severity": {
          "$ref": "#/definitions/ruleSeverity"
        },
        "description": {
          "type": "string",
          "description": "Human-readable explanation of the rule"
        },
        "translations": {
          "type": "object",
          "description": "Translations per language",
          "minProperties": 1,
          "patternProperties": {
            "^[a-z]{2}_[A-Z]{2}$": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "source_url": {
          "type": "string",
          "format": "uri",
          "description": "Optional URL for documentation"
        },
        "direction": {
          "$ref": "#/definitions/orderDirection",
          "description": "Direction for order constraint"
        }
      }
    }
  }
}