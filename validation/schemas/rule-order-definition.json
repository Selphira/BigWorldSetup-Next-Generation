{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://selphira.github.io/BigWorldSetup-Enhanced-Edition/validation/schemas/order.json",
  "title": "Big World Setup - Enhanced Edition: Order Rules",
  "description": "Schema for validating order rules files",
  "type": "object",
  "required": ["rules"],
  "additionalProperties": false,
  "properties": {
    "rules": {
      "type": "array",
      "items": {"$ref": "#/definitions/orderRule"}
    }
  },
  "definitions": {
    "componentReference": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_#'-]+(:([0-9]+|\\*|[0-9]+\\?[0-9_]+))?$",
      "description": "Component reference as string: 'mod_id' or 'mod_id:component'"
    },
    "componentReferenceList": {
      "type": "array",
      "minItems": 1,
      "items": {"$ref": "#/definitions/componentReference"}
    },
    "ruleSeverity": {
      "type": "string",
      "enum": ["error", "warning", "info"],
      "default": "error"
    },
    "orderDirection": {
      "type": "string",
      "enum": ["before", "after"],
      "default": "before"
    },
    "orderRule": {
      "type": "object",
      "required": ["source", "target"],
      "additionalProperties": false,
      "properties": {
        "severity": {
          "$ref": "#/definitions/ruleSeverity",
          "description": "Severity level of the rule violation"
        },
        "description": {
          "type": "string",
          "description": "Human-readable explanation of the rule"
        },
        "source_url": {
          "type": "string",
          "format": "uri",
          "description": "Optional URL for documentation"
        },
        "direction": {
          "$ref": "#/definitions/orderDirection",
          "description": "Direction for order constraint"
        },
        "source": {
          "$ref": "#/definitions/componentReferenceList",
          "description": "Source component(s) of the rule"
        },
        "target": {
          "$ref": "#/definitions/componentReferenceList",
          "description": "Target component(s) of the rule"
        }
      }
    }
  }
}